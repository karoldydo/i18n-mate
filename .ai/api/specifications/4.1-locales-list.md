# 4.1 List Project Locales

**Endpoint:** `GET /rest/v1/rpc/list_project_locales_with_default?p_project_id={project_id}`
**Description:** Get all locales for a project with default locale indicator
**Authentication:** Required

**Success Response (200 OK):**

```json
[
  {
    "created_at": "2025-01-15T10:00:00Z",
    "id": "uuid",
    "is_default": true,
    "label": "English",
    "locale": "en",
    "project_id": "uuid",
    "updated_at": "2025-01-15T10:00:00Z"
  },
  {
    "created_at": "2025-01-15T10:05:00Z",
    "id": "uuid",
    "is_default": false,
    "label": "Polski",
    "locale": "pl",
    "project_id": "uuid",
    "updated_at": "2025-01-15T10:05:00Z"
  }
]
```

**Error Responses:**

**401 Unauthorized:**

```json
{
  "data": null,
  "error": {
    "code": 401,
    "message": "Missing or invalid auth token"
  }
}
```

**403 Forbidden:**

```json
{
  "data": null,
  "error": {
    "code": 403,
    "message": "Project not found or access denied"
  }
}
```

**Business Logic:**

- RPC function `list_project_locales_with_default` joins with `projects` table
- Returns all project locales with `is_default` boolean flag
- Orders by `is_default DESC, created_at ASC` (default locale first)
- Enforces project ownership via RLS and explicit auth validation

**Caching Strategy:**

- **TanStack Query Configuration:**
  - `staleTime: 10 * 60 * 1000` (10 minutes)
  - `gcTime: 30 * 60 * 1000` (30 minutes)
- **Cache Key:** `['project-locales', 'list', projectId]`
- **Invalidation Triggers:**
  - Add locale → invalidate project locales list cache
  - Update locale → invalidate project locales list cache
  - Delete locale → invalidate project locales list cache
- **Rationale:** Locales change infrequently, long cache time improves performance
