# 4.2 Add Locale to Project (Legacy)

**Endpoint:** `POST /rest/v1/project_locales`
**Description:** Add new locale to project. **DEPRECATED - Use atomic endpoint instead.**
**Authentication:** Required

> **⚠️ DEPRECATED:** This endpoint is maintained for backward compatibility. Use [4.2-locales-add-atomic.md](./4.2-locales-add-atomic.md) for new implementations due to better error handling and verification.

**Request Body:**

```json
{
  "label": "Polski",
  "locale": "pl",
  "project_id": "uuid"
}
```

**Success Response (201 Created):**

```json
{
  "created_at": "2025-01-15T10:05:00Z",
  "id": "uuid",
  "label": "Polski",
  "locale": "pl",
  "project_id": "uuid",
  "updated_at": "2025-01-15T10:05:00Z"
}
```

**Error Responses:**

- `400 Bad Request` - Invalid locale format (must be ll or ll-CC)
- `409 Conflict` - Locale already exists for project
- `403 Forbidden` - Project not owned by user

**Validation:**

- `locale`: BCP-47 format (ll or ll-CC only), normalized via trigger
- `label`: required, max 64 chars
- Trigger `normalize_locale_trigger` normalizes to lowercase-language / UPPERCASE-REGION

**Business Logic:**

- Trigger `fan_out_translations_on_locale_insert_trigger` creates translation records:
  - For all existing keys in project
  - With `value = NULL` (missing)
  - With `updated_source = 'user'`
- Emit `language_added` telemetry event with `locale_count` in properties

**Side Effects:**

- **Telemetry Event Emitted:** `language_added`
  - Properties: `{ locale: "pl", locale_count: 2 }`
  - Used for KPI tracking: projects with 2+ languages after 7 days

**Example Telemetry Event:**

```json
{
  "created_at": "2025-01-15T10:05:00Z",
  "event_name": "language_added",
  "project_id": "550e8400-e29b-41d4-a716-446655440000",
  "properties": {
    "locale": "pl",
    "locale_count": 2
  }
}
```

**Performance Impact:**

- For projects with many keys (>100), fan-out may take 2-5 seconds
- Consider using atomic endpoint for better error handling and verification
