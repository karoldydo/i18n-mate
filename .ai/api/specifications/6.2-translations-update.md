# 6.2 Update Translation (Inline Edit)

**Endpoint:** `PATCH /rest/v1/translations?project_id=eq.{project_id}&key_id=eq.{key_id}&locale=eq.{locale}`  
**Description:** Update translation value (autosave). **Updates metadata.**  
**Authentication:** Required

**Request Body:**

```json
{
  "is_machine_translated": false,
  "updated_by_user_id": "uuid",
  "updated_source": "user",
  "value": "Witaj w domu"
}
```

**Success Response (200 OK):**

```json
{
  "is_machine_translated": false,
  "key_id": "uuid",
  "locale": "pl",
  "project_id": "uuid",
  "updated_at": "2025-01-15T11:00:00Z",
  "updated_by_user_id": "uuid",
  "updated_source": "user",
  "value": "Witaj w domu"
}
```

**Error Responses:**

- `400 Bad Request` - Validation error (empty value for default locale, newline character)
- `404 Not Found` - Translation not found
- `409 Conflict` - Optimistic lock failure (use optimistic locking pattern)

**Validation:**

- `value`: max 250 chars, no newline, empty converted to NULL (except default locale)
- For default locale: value cannot be NULL or empty (trigger enforces)
- Trigger `trim_translation_value_trigger` auto-trims whitespace
- Trigger `validate_default_locale_value_trigger` prevents NULL for default locale

**Optimistic Locking (Recommended):**
Include `updated_at` in WHERE clause to prevent lost updates:

```sql
PATCH /rest/v1/translations?project_id=eq.{uuid}&key_id=eq.{uuid}&locale=eq.pl&updated_at=eq.2025-01-15T10:20:00Z
```

If no rows affected, return 409 Conflict and client must refetch.
