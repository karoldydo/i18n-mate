# 3.3 Create Project

**Endpoint:** `POST /rest/v1/rpc/create_project_with_default_locale`
**Description:** Atomically create new project with default locale. Creates project and inserts default locale in single transaction.
**Authentication:** Required

**Request Body:**

```json
{
  "p_default_locale": "en",
  "p_default_locale_label": "English",
  "p_description": "Main application translations",
  "p_name": "My App",
  "p_prefix": "app"
}
```

**Field Validation:**

- `p_name`: required, CITEXT, unique per owner
- `p_prefix`: required, 2-4 chars, `[a-z0-9._-]`, no trailing dot, unique per owner
- `p_default_locale`: required, BCP-47 format (ll or ll-CC)
- `p_default_locale_label`: required, human-readable label (max 64 characters)
- `p_description`: optional, project description

**Success Response (200 OK):**

```json
[
  {
    "created_at": "2025-01-15T10:00:00Z",
    "default_locale": "en",
    "description": "Main application translations",
    "id": "uuid",
    "name": "My App",
    "prefix": "app",
    "updated_at": "2025-01-15T10:00:00Z"
  }
]
```

**Error Responses:**

**400 Bad Request (Invalid project name):**

```json
{
  "data": null,
  "error": {
    "code": 400,
    "details": {
      "constraint": "required",
      "field": "p_name"
    },
    "message": "Project name is required"
  }
}
```

**400 Bad Request (Invalid prefix format):**

```json
{
  "data": null,
  "error": {
    "code": 400,
    "details": {
      "constraint": "regex",
      "field": "p_prefix"
    },
    "message": "Prefix must be 2-4 characters and contain only lowercase letters, numbers, dots, underscores, and hyphens"
  }
}
```

**400 Bad Request (Invalid locale format):**

```json
{
  "data": null,
  "error": {
    "code": 400,
    "details": {
      "constraint": "regex",
      "field": "p_default_locale"
    },
    "message": "Locale must be in BCP-47 format (e.g., \"en\" or \"en-US\")"
  }
}
```

**401 Unauthorized:**

```json
{
  "data": null,
  "error": {
    "code": 401,
    "message": "Authentication required"
  }
}
```

**409 Conflict (Project name exists):**

```json
{
  "data": null,
  "error": {
    "code": 409,
    "details": {
      "constraint": "projects_name_owner_unique"
    },
    "message": "Project name already exists for user"
  }
}
```

**409 Conflict (Prefix exists):**

```json
{
  "data": null,
  "error": {
    "code": 409,
    "details": {
      "constraint": "projects_prefix_owner_unique"
    },
    "message": "Prefix already exists for user"
  }
}
```

**Atomic Operations:**

RPC function `create_project_with_default_locale()` performs:

1. Insert project with `owner_user_id = auth.uid()`
2. Insert default locale into `project_locales`
3. Emit `project_created` telemetry event
4. Return project data (excluding `owner_user_id` for security)

**Client Usage:**

Use `.maybeSingle()` to extract single object from array response.
